<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZenTime - Offline Productivity Hub</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transpilation in browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .tabular-nums { font-variant-numeric: tabular-nums; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Icons Component Helper
        const Icon = ({ name, size = 20, className = "" }) => {
            const [svg, setSvg] = useState("");
            useEffect(() => {
                if (window.lucide) {
                    const iconSvg = window.lucide.createIcons();
                }
            }, [name]);
            // Simplified for this standalone version: we'll use string-based icons or Lucide's replace
            return <i data-lucide={name} className={className} style={{ width: size, height: size }}></i>;
        };

        const formatTime = (seconds) => {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        };

        function App() {
            const [activeTab, setActiveTab] = useState('calendar');
            const [reminders, setReminders] = useState([]);
            const [currentDate, setCurrentDate] = useState(new Date());
            
            // Pomodoro State
            const [pomodoroMode, setPomodoroMode] = useState('work');
            const [timeLeft, setTimeLeft] = useState(25 * 60);
            const [isActive, setIsActive] = useState(false);

            // Replace icons after render
            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            });

            const playAlarm = () => {
                const context = new (window.AudioContext || window.webkitAudioContext)();
                const osc = context.createOscillator();
                const gain = context.createGain();
                osc.connect(gain);
                gain.connect(context.destination);
                osc.type = 'sine';
                osc.frequency.setValueAtTime(440, context.currentTime);
                osc.start();
                osc.stop(context.currentTime + 1);
            };

            // Pomodoro Timer Logic
            useEffect(() => {
                let interval = null;
                if (isActive && timeLeft > 0) {
                    interval = setInterval(() => setTimeLeft(prev => prev - 1), 1000);
                } else if (timeLeft === 0) {
                    setIsActive(false);
                    playAlarm();
                    const nextMode = pomodoroMode === 'work' ? 'shortBreak' : 'work';
                    setPomodoroMode(nextMode);
                    setTimeLeft(nextMode === 'work' ? 25 * 60 : 5 * 60);
                }
                return () => clearInterval(interval);
            }, [isActive, timeLeft, pomodoroMode]);

            // Alarm Checker
            useEffect(() => {
                const timer = setInterval(() => {
                    const now = new Date();
                    const currentFormatted = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                    
                    setReminders(prev => prev.map(r => {
                        if (r.time === currentFormatted && !r.notified) {
                            playAlarm();
                            return { ...r, notified: true };
                        }
                        return r;
                    }));
                }, 1000);
                return () => clearInterval(timer);
            }, []);

            const addReminder = (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const newReminder = {
                    id: Date.now(),
                    text: formData.get('text'),
                    time: formData.get('time'),
                    notified: false
                };
                setReminders([...reminders, newReminder]);
                e.target.reset();
            };

            const getDaysInMonth = (date) => {
                const year = date.getFullYear();
                const month = date.getMonth();
                const days = new Date(year, month + 1, 0).getDate();
                const firstDay = new Date(year, month, 1).getDay();
                return { days, firstDay };
            };

            const { days, firstDay } = getDaysInMonth(currentDate);
            const calendarGrid = [];
            for (let i = 0; i < firstDay; i++) calendarGrid.push(null);
            for (let i = 1; i <= days; i++) calendarGrid.push(i);

            return (
                <div className="flex h-screen overflow-hidden">
                    {/* Sidebar */}
                    <aside className="w-64 bg-white border-r border-slate-200 p-6 flex flex-col gap-8">
                        <div className="flex items-center gap-2 px-2">
                            <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white">
                                <i data-lucide="clock" size="20"></i>
                            </div>
                            <h1 className="text-xl font-bold tracking-tight">ZenTime</h1>
                        </div>
                        
                        <nav className="flex flex-col gap-2">
                            {[
                                { id: 'calendar', icon: 'calendar', label: 'Calendar' },
                                { id: 'reminders', icon: 'bell', label: 'Alarms' },
                                { id: 'pomodoro', icon: 'timer', label: 'Pomodoro' }
                            ].map(item => (
                                <button
                                    key={item.id}
                                    onClick={() => setActiveTab(item.id)}
                                    className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${
                                        activeTab === item.id 
                                            ? 'bg-blue-600 text-white shadow-lg' 
                                            : 'text-slate-600 hover:bg-slate-100'
                                    }`}
                                >
                                    <i data-lucide={item.icon} style={{width: 20, height: 20}}></i>
                                    <span className="font-medium">{item.label}</span>
                                </button>
                            ))}
                        </nav>
                    </aside>

                    {/* Main */}
                    <main className="flex-1 overflow-y-auto p-8">
                        <header className="mb-8 flex justify-between items-center">
                            <h2 className="text-3xl font-bold capitalize">{activeTab}</h2>
                            <div className="text-right font-semibold">
                                {new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' })}
                            </div>
                        </header>

                        {activeTab === 'calendar' && (
                            <div className="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden max-w-5xl">
                                <div className="p-6 border-b border-slate-100 flex justify-between items-center">
                                    <h3 className="text-lg font-bold">
                                        {currentDate.toLocaleString('default', { month: 'long', year: 'numeric' })}
                                    </h3>
                                    <div className="flex gap-2">
                                        <button onClick={() => setCurrentDate(new Date(currentDate.setMonth(currentDate.getMonth() - 1)))} className="p-2 hover:bg-slate-100 rounded-full"><i data-lucide="chevron-left"></i></button>
                                        <button onClick={() => setCurrentDate(new Date(currentDate.setMonth(currentDate.getMonth() + 1)))} className="p-2 hover:bg-slate-100 rounded-full"><i data-lucide="chevron-right"></i></button>
                                    </div>
                                </div>
                                <div className="grid grid-cols-7 text-center font-bold text-slate-400 py-4 uppercase text-xs tracking-widest">
                                    {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(d => <div key={d}>{d}</div>)}
                                </div>
                                <div className="grid grid-cols-7 border-t border-slate-50">
                                    {calendarGrid.map((day, idx) => (
                                        <div key={idx} className={`h-24 md:h-32 border-r border-b border-slate-50 p-2 hover:bg-blue-50 transition-colors ${!day ? 'bg-slate-50/50' : ''}`}>
                                            {day && (
                                                <span className={`inline-block w-8 h-8 leading-8 text-center rounded-full font-bold ${
                                                    day === new Date().getDate() && currentDate.getMonth() === new Date().getMonth()
                                                    ? 'bg-blue-600 text-white' : 'text-slate-700'
                                                }`}>
                                                    {day}
                                                </span>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {activeTab === 'reminders' && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl">
                                <div className="bg-white p-8 rounded-3xl shadow-sm border border-slate-200">
                                    <h3 className="text-xl font-bold mb-6">New Reminder</h3>
                                    <form onSubmit={addReminder} className="space-y-4">
                                        <input name="text" required placeholder="Task name..." className="w-full p-4 rounded-xl border border-slate-200" />
                                        <input type="time" name="time" required className="w-full p-4 rounded-xl border border-slate-200" />
                                        <button className="w-full bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg hover:bg-blue-700 transition-all">Add Alarm</button>
                                    </form>
                                </div>
                                <div className="bg-white p-8 rounded-3xl shadow-sm border border-slate-200">
                                    <h3 className="text-xl font-bold mb-6">Active Alarms</h3>
                                    <div className="space-y-3">
                                        {reminders.map(r => (
                                            <div key={r.id} className="flex items-center justify-between p-4 bg-slate-50 rounded-2xl border border-slate-100">
                                                <div>
                                                    <div className="font-bold">{r.text}</div>
                                                    <div className="text-sm text-slate-500">{r.time}</div>
                                                </div>
                                                <button onClick={() => setReminders(reminders.filter(x => x.id !== r.id))} className="text-slate-400 hover:text-red-500"><i data-lucide="trash-2"></i></button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'pomodoro' && (
                            <div className="flex flex-col items-center py-10">
                                <div className="bg-white p-12 rounded-[3rem] shadow-xl border border-slate-100 w-full max-w-md text-center">
                                    <div className="inline-flex gap-2 mb-8 bg-slate-100 p-1.5 rounded-full">
                                        <button onClick={() => { setPomodoroMode('work'); setTimeLeft(25 * 60); setIsActive(false); }} className={`px-6 py-2 rounded-full text-sm font-bold ${pomodoroMode === 'work' ? 'bg-white shadow text-blue-600' : 'text-slate-500'}`}>Focus</button>
                                        <button onClick={() => { setPomodoroMode('shortBreak'); setTimeLeft(5 * 60); setIsActive(false); }} className={`px-6 py-2 rounded-full text-sm font-bold ${pomodoroMode === 'shortBreak' ? 'bg-white shadow text-blue-600' : 'text-slate-500'}`}>Break</button>
                                    </div>
                                    <div className="text-8xl font-black text-slate-800 tabular-nums mb-10">{formatTime(timeLeft)}</div>
                                    <div className="flex gap-4">
                                        <button onClick={() => setIsActive(!isActive)} className="flex-1 bg-blue-600 text-white py-4 rounded-2xl text-xl font-bold shadow-lg hover:bg-blue-700 transition-all">
                                            {isActive ? 'Pause' : 'Start'}
                                        </button>
                                        <button onClick={() => { setIsActive(false); setTimeLeft(pomodoroMode === 'work' ? 25 * 60 : 5 * 60); }} className="p-4 bg-slate-100 rounded-2xl hover:bg-slate-200"><i data-lucide="rotate-ccw"></i></button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>